# Production configuration example
# Save as /etc/sentinel/shield.conf

hostname sentinel-prod

! ===== Zones =====

zone openai-gpt4
  type llm
  provider openai
  description "OpenAI GPT-4 Production"
!
zone openai-gpt35
  type llm
  provider openai
  description "OpenAI GPT-3.5 Production"
!
zone anthropic-claude
  type llm
  provider anthropic
  description "Anthropic Claude"
!
zone rag-pinecone
  type rag
  provider pinecone
  description "RAG Vector Store"
!
zone mcp-tools
  type mcp
  description "MCP Tool Integration"
!

! ===== Access Control Lists =====

access-list 100
  remark -- Input Protection --
  
  ! Prompt injection patterns
  shield-rule 10 block input llm pattern "ignore.*all.*previous"
  shield-rule 11 block input llm pattern "ignore.*instructions"
  shield-rule 12 block input llm pattern "disregard.*previous"
  shield-rule 13 block input llm pattern "forget.*everything"
  shield-rule 14 block input llm pattern "you are now"
  shield-rule 15 block input llm pattern "pretend.*to.*be"
  
  ! System prompt extraction
  shield-rule 20 block input llm pattern "reveal.*system.*prompt"
  shield-rule 21 block input llm pattern "show.*your.*instructions"
  shield-rule 22 block input llm pattern "what.*are.*your.*rules"
  
  ! Jailbreak patterns
  shield-rule 30 block input llm pattern "DAN.*mode"
  shield-rule 31 block input llm pattern "developer.*mode"
  shield-rule 32 block input llm pattern "ignore.*safety"
  
  ! High entropy (encoded payloads)
  shield-rule 40 block input llm entropy-high
  
  ! Base64 obfuscation
  shield-rule 50 block input llm base64-encoded
  
  remark -- Output Protection --
  
  ! Sensitive data
  shield-rule 100 quarantine output llm contains "password"
  shield-rule 101 quarantine output llm contains "api_key"
  shield-rule 102 quarantine output llm contains "secret"
  shield-rule 103 quarantine output llm contains "private_key"
  shield-rule 104 quarantine output llm pattern "\\d{3}-\\d{2}-\\d{4}"  ! SSN
  
  ! Default allow
  shield-rule 1000 allow input any
  shield-rule 1001 allow output any
!

access-list 200
  remark -- RAG Protection --
  
  shield-rule 10 block input rag sql-injection
  shield-rule 20 block input rag contains "DROP TABLE"
  shield-rule 30 block input rag contains "DELETE FROM"
  
  shield-rule 1000 allow input any
  shield-rule 1001 allow output any
!

access-list 300
  remark -- MCP Tool Protection --
  
  shield-rule 10 block input mcp contains "rm -rf"
  shield-rule 11 block input mcp contains "sudo"
  shield-rule 12 block input mcp pattern "curl.*\\|.*sh"
  
  shield-rule 1000 allow input any
  shield-rule 1001 allow output any
!

! ===== Apply ACLs to Zones =====

apply zone openai-gpt4 in 100 out 100
apply zone openai-gpt35 in 100 out 100
apply zone anthropic-claude in 100 out 100
apply zone rag-pinecone in 200 out 200
apply zone mcp-tools in 300 out 300

! ===== Rate Limiting =====

ratelimit openai-gpt4 100 200
ratelimit openai-gpt35 200 400
ratelimit rag-pinecone 500 1000

! ===== High Availability =====

ha peer 10.0.0.2:5400
ha peer 10.0.0.3:5400
ha heartbeat-interval 1000
ha failover-timeout 5000
ha preemption enable

! ===== Logging =====

logging level info
logging audit /var/log/sentinel/audit.log
logging syslog 10.0.0.10:514

! ===== API =====

api enable
api port 8080
api auth-token ${SHIELD_API_TOKEN}

! ===== Metrics =====

metrics enable
metrics port 9090
metrics path /metrics

end
