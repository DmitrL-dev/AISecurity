/*
 * SENTINEL Shield - Example Configuration
 */

!
! SENTINEL Shield Configuration
! Example configuration for protecting LLM and RAG systems
!
hostname sentinel

! === Zone Definitions ===

zone openai-gpt4
  type llm
  provider openai
  description "Production GPT-4 API"
!
zone claude-sonnet
  type llm
  provider anthropic
  description "Claude 3.5 Sonnet"
!
zone pinecone-prod
  type rag
  provider pinecone
  description "Production vector database"
!
zone langchain-agent
  type agent
  description "LangChain agent with tools"
!
zone shell-executor
  type tool
  description "Shell command execution"
!
zone mcp-server
  type mcp
  description "Model Context Protocol server"
!

! === Shield Rules ===

! Block prompt injection attempts
shield-rule 10 block input llm pattern "ignore.*instructions"
shield-rule 11 block input llm pattern "disregard.*previous"
shield-rule 12 block input llm pattern "forget.*everything"
shield-rule 13 block input llm pattern "new.*system.*prompt"
shield-rule 14 block input llm pattern "reveal.*instructions"

! Block high entropy payloads (potential encoded attacks)
shield-rule 20 quarantine input llm entropy-high

! Block RAG poisoning
shield-rule 30 block input rag sql-injection
shield-rule 31 block input rag contains "__metadata__"

! Block dangerous tool commands
shield-rule 40 block input tool pattern "rm -rf"
shield-rule 41 block input tool pattern "del /f"
shield-rule 42 block input tool pattern "DROP DATABASE"

! Block data exfiltration in responses
shield-rule 100 quarantine output llm contains "password"
shield-rule 101 quarantine output llm contains "api_key"
shield-rule 102 quarantine output llm contains "secret"
shield-rule 103 block output llm contains "BEGIN RSA PRIVATE"

! Log all MCP operations
shield-rule 200 log input mcp pattern ".*"
shield-rule 201 log output mcp pattern ".*"

! Default allow
shield-rule 1000 allow input any
shield-rule 1001 allow output any

!

! === Apply Rules to Zones ===

apply zone openai-gpt4 in 100 out 100
apply zone claude-sonnet in 100 out 100
apply zone pinecone-prod in 100 out 100
apply zone langchain-agent in 100 out 100
apply zone shell-executor in 100 out 100
apply zone mcp-server in 100 out 100

!
end
